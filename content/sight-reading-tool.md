---
title: "IC è§†å¥å·¥å…·"
slug: /sight-reading-tool/
description: ä¸“ä¸šçº§è§†å¥æ—‹å¾‹ç”Ÿæˆå™¨ï¼ŒåŠ©åŠ›éŸ³ä¹å­¦ä¹ è€…å¿«é€Ÿæå‡è¯»è°±æŠ€èƒ½ï¼
image: images/sight-reading-tool.png
categories:
weight: 3
tags:
  - web
draft: false
---

# IC Studio - ä¸“ä¸šçº§è§†å¥æ—‹å¾‹ç”Ÿæˆå™¨

![IC Studio è§†å¥å®Œæ•´ç•Œé¢](/images/sight-reading-tool-interface.png)

## âœ¨ æ ¸å¿ƒç‰¹è‰²
- **æ™ºèƒ½ç”Ÿæˆé€»è¾‘**ï¼šæ—‹å¾‹è™½ç”±ç®—æ³•éšæœºç”Ÿæˆï¼Œä½†å¹¶éå®Œå…¨æ— åºï¼›å®ƒä»¬ä¿æŒ**å¹³è¡¡çš„æ—‹å¾‹çº¿æ¡**ä¸**éŸ³ä¹æ€§**ï¼Œç¡®ä¿ç»ƒä¹ æ›²ç›®æ—¢æœ‰æŒ‘æˆ˜ä¹Ÿå…·å¤‡å¯å¬æ€§ã€‚ 
- **ä¸“ä¸šä¹è°±æ¸²æŸ“**ï¼šåŸºäº OpenSheetMusicDisplayå¼•æ“ï¼Œæä¾›å‡ºç‰ˆçº§åˆ«çš„æ¸…æ™°ä¹è°±æ˜¾ç¤ºã€‚

![ç”Ÿæˆçš„ä¹è°±ç¤ºä¾‹](/images/sight-reading-tool-score-example.png)

- **å®Œå…¨è‡ªå®šä¹‰**ï¼šæ”¯æŒè°ƒå·ã€éŸ³åŸŸã€èŠ‚å¥ç±»å‹ã€éŸ³ç¨‹è·¨åº¦ã€ä¸´æ—¶è®°å·ç­‰å¤šç»´åº¦ä¸ªæ€§åŒ–è®¾ç½®ã€‚

![IC Studio è§†å¥å·¥å…·å®Œæ•´ç•Œé¢](/images/sight-reading-tool-full-interface.png)

## ğŸ¹ ä¸“ä¸šåŠŸèƒ½
- **24 ä¸ªå¤§å°è°ƒæ”¯æŒ**ï¼šæ¶µç›–æ‰€æœ‰å¸¸è§è°ƒæ€§ï¼Œä»¥åŠå°è°ƒä¸­çš„**è‡ªç„¶å°è°ƒ**ã€**å’Œå£°å°è°ƒ**ä¸**æ—‹å¾‹å°è°ƒ**çš„å˜åŒ–å¤„ç†ã€‚  
- **ä¸°å¯ŒèŠ‚å¥é€‰æ‹©**ï¼šä»å…¨éŸ³ç¬¦åˆ°åå…­åˆ†éŸ³ç¬¦ï¼Œå›Šæ‹¬é™„ç‚¹ã€ä¸‰è¿éŸ³ç­‰å¤æ‚èŠ‚å¥ã€‚

![èŠ‚å¥è®¾ç½®è¯¦ç»†é…ç½®](/images/sight-reading-tool-rhythm-settings.png)  
- **éŸ³ç¨‹è·¨åº¦æ§åˆ¶**ï¼šè‡ªç”±è®¾å®šæ—‹å¾‹çš„è·³è¿›ä¸çº§è¿›èŒƒå›´ï¼ŒåŒ¹é…ä¸åŒå­¦ä¹ é˜¶æ®µã€‚  
- **ä¸´æ—¶è®°å·ç³»ç»Ÿ**ï¼šæ™ºèƒ½æ’å…¥å‡é™å·ï¼Œå¢åŠ éŸ³ä¹è¡¨ç°åŠ›ä¸æŒ‘æˆ˜æ€§ã€‚  
- **å‰ä»–æŠ€å·§æ”¯æŒ**ï¼šé‡éŸ³ã€æ–­å¥ã€çŸ­å€šéŸ³ã€å‡»å¼¦ã€å‹¾å¼¦å…¨é¢æ¶µç›–ã€‚

![æ¼”å¥æŠ€å·§è¯¦ç»†è®¾ç½®](/images/sight-reading-tool-articulations.png)

- **å…¨æ‹å·æ”¯æŒ**ï¼šå®Œæ•´è¦†ç›– 4/4ã€3/4ã€6/8ç­‰å¸¸ç”¨æ‹å·ï¼Œæ¯ç§æ‹å·çš†æœ‰ç‹¬ç‰¹èŠ‚å¥æ¨¡å¼ã€‚
- **å†…ç½®èŠ‚æ‹å™¨**ï¼šæ— éœ€é¢å¤–å·¥å…·ï¼Œå³å¯åœ¨ç»ƒä¹ æ—¶ä¿æŒç¨³å®šçš„èŠ‚å¥æ„Ÿã€‚ 

## ğŸ”® æœªæ¥åŠŸèƒ½

- **éŸ³ç¨‹è§†å¥**ï¼šéšæœºç”Ÿæˆæœ‰éŸ³ä¹æ€§ä»¥åŠæ—‹å¾‹çº¿æ¡çš„éŸ³ç¨‹ï¼Œå¸®åŠ©ä½ ç†Ÿæ‚‰æŒ‡æ¿éŸ³ç¨‹é€»è¾‘ã€‚
- **å’Œå¼¦è§†å¥**ï¼šéšæœºç”Ÿæˆ [Guitar voicings](/guitar-voicings/)ï¼ˆä¸‰å’Œå¼¦ï¼Œdrop 2ï¼Œdrop 3ï¼Œshell voicingsç­‰ï¼‰ï¼Œæé«˜ä½ è§†å¥å’Œå¼¦çš„èƒ½åŠ›ã€‚
- **ä½éŸ³ç”Ÿæˆå™¨**ï¼šéšæœºç”Ÿæˆä¸€ä¸²ä½éŸ³ï¼Œå¯ä»¥ç”¨æ¥ç»ƒä¹ å››éƒ¨å’Œå£°ï¼Œå’Œå¼¦å†™ä½œã€‚ï¼ˆä¹‹åæˆ‘ä¼šå•ç‹¬å‡ºä¸€æœŸè§†é¢‘è®²è§£ï¼‰
- **å’Œå¼¦è¿›è¡Œç”Ÿæˆå™¨**ï¼šéšæœºç”Ÿæˆä¸€ä¸²**å’Œå¼¦ä»£å·**ï¼Œä¹æ‰‹å¯ä»¥æ ¹æ®å’Œå¼¦ä»£å·è‡ªè¡Œé…å’Œå£°ã€‚
ï¼ˆç°åœ¨è´­ä¹°å¯ä»¥åœ¨æœªæ¥å…è´¹è§£é”ä»¥ä¸‹åŠŸèƒ½ï¼Œä¹‹åå‡ºäº†è¿™äº›åŠŸèƒ½ä¹‹åä¼šæ¶¨ä»·ï¼‰
 
## ğŸ‘©â€ğŸ“ é€‚ç”¨äººç¾¤
- **éŸ³ä¹å­¦ç”Ÿ / è‡ªå­¦è€…**ï¼šå¿«é€Ÿæå‡è§†å¥æ°´å¹³ã€‚
- **éŸ³ä¹æ•™å¸ˆ**ï¼šé«˜æ•ˆç”Ÿæˆæ•™å­¦ç´ æï¼Œè½»æ¾å®šåˆ¶ä¸ªæ€§åŒ–ç»ƒä¹ å†…å®¹ã€‚

## ğŸ¯ ç«‹å³è¡ŒåŠ¨ 
âš¡ **æ—©é¸Ÿä»· 48.00Â¥**ï¼ˆæˆªæ­¢äº10æœˆ01æ—¥ï¼‰â€”â€” ç°åœ¨è´­ä¹°å¯åœ¨æœªæ¥**å…è´¹è§£é”**æ›´è¿›é˜¶çš„åŠŸèƒ½ï¼

<div style="display: flex; gap: 30px; margin: 30px auto; max-width: 1000px; align-items: flex-start; flex-wrap: wrap;">

<div style="flex: 1; min-width: 300px; padding: 25px; background: linear-gradient(135deg, #ffffff 0%, #f8f9ff 100%); border-radius: 16px; box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1); border: 2px solid #e6edff; text-align: center;">
<div style="margin-bottom: 20px;">
<h3 style="color: #4a5568; margin-bottom: 6px; font-size: 20px;">å›½å†…ç”¨æˆ·è´­ä¹°</h3>
<p style="color: #718096; font-size: 14px; margin: 0;">æ”¯æŒ 7 å¤©æ— ç†ç”±é€€æ¬¾</p>
</div>
<div style="display: flex; gap: 15px; align-items: stretch; justify-content: center;">
<div style="flex: 1; display: flex; flex-direction: column;">
<a href="/tools/sight-reading-generator.html" target="_blank" style="display: block; background: #f8f9fa; color: #667eea; padding: 15px 20px; border: 2px solid #667eea; border-radius: 8px; text-decoration: none; font-weight: 600; font-size: 15px; transition: all 0.3s ease; margin-bottom: 8px; text-align: center; flex-grow: 1; min-height: 50px; display: flex; align-items: center; justify-content: center;" onmouseover="this.style.background='#667eea'; this.style.color='white';" onmouseout="this.style.background='#f8f9fa'; this.style.color='#667eea';">å…è´¹è¯•ç”¨</a>
<p style="color: #888; font-size: 12px; margin: 0; text-align: center; line-height: 1.3;">10åˆ†é’Ÿä½“éªŒ<br/>å·²è´­ç”¨æˆ·ç›´æ¥ä½¿ç”¨</p>
</div>
<div style="flex: 1; display: flex; flex-direction: column;">
<button id="zpay-btn" onclick="window.createZPayment()" style="background: linear-gradient(135deg, #1677FF 0%, #00A0E9 100%); color: white; padding: 15px 20px; border: none; border-radius: 8px; font-weight: 600; font-size: 15px; box-shadow: 0 4px 15px rgba(22, 119, 255, 0.3); transition: all 0.3s ease; cursor: pointer; margin-bottom: 8px; width: 100%; text-align: center; flex-grow: 1; min-height: 50px;" onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 6px 20px rgba(22, 119, 255, 0.4)';" onmouseout="this.style.transform='translateY(0px)'; this.style.boxShadow='0 4px 15px rgba(22, 119, 255, 0.3)';">æ”¯ä»˜å®æ”¯ä»˜</button>
<p style="color: #888; font-size: 12px; margin: 0; text-align: center; line-height: 1.3;">Â¥48.00<br/>æ—©é¸Ÿä»·</p>
</div>
</div>

<!-- è®¿é—®ç éªŒè¯åŒºåŸŸ -->
<div style="margin-top: 25px; padding-top: 20px; border-top: 1px solid #e6edff;">
    <h3 style="color: #667eea; margin-bottom: 15px; font-size: 18px;">å·²æœ‰è®¿é—®ç ï¼Ÿç«‹å³ä½¿ç”¨</h3>
    <p style="color: #888; font-size: 12px; margin: 6; text-align: center; line-height: 1;">å¯ä¸‹è½½ç”µè„‘è½¯ä»¶&æŸ¥è¯¢è®¢å•å·</p>
    <div style="display: flex; gap: 10px; align-items: center;">
        <input type="text" id="access-code-input" placeholder="è¾“å…¥è®¿é—®ç (11-12ä½)" 
               style="flex: 1; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px; text-transform: uppercase; transition: border-color 0.3s ease;"
               maxlength="12" oninput="handleInputChange()" onkeyup="handleInputChange()" onfocus="this.style.borderColor='#667eea'" onblur="this.style.borderColor='#ddd'">
        <button id="verify-btn" onclick="handleVerifyClick()" 
                style="padding: 12px 24px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: not-allowed; font-weight: 600; font-size: 14px; transition: all 0.3s ease; opacity: 1;"
                onmousedown="this.style.opacity='0.3'; this.style.transform='scale(0.98)'"
                onmouseup="this.style.transform='scale(1)'; setTimeout(() => { this.style.opacity='1'; }, 100)"
                onmouseleave="this.style.transform='scale(1)'; setTimeout(() => { this.style.opacity='1'; }, 100)">
            éªŒè¯
        </button>
    </div>
    <div id="verify-result" style="margin-top: 15px; font-size: 14px; text-align: center;"></div>
</div>

</div>

<iframe src="https://icstudio3.gumroad.com/l/sight-reading-tools" frameborder="0" width="370" height=500" style="border:0;"></iframe>

</div>

## â“ å¸¸è§é—®é¢˜ FAQ

<div style="max-width: 800px; margin: 30px auto; background: #f9f9f9; padding: 30px; border-radius: 12px;">

### å¿˜è®°è®¿é—®ç äº†æ€ä¹ˆåŠï¼Ÿ

 <div style="background: #fff3e0; padding: 20px; border-radius: 8px; margin: 15px 0; border-left: 4px solid #ff9800;">
å¦‚æœæ‚¨å¿˜è®°äº†è®¿é—®ç ï¼Œå¯ä»¥é€šè¿‡æ‚¨çš„è®¢å•å·æ‰¾å›ï¼š

<div style="margin: 15px 0; text-align: center;">
<button id="recover-access-code-btn" style="
  background: linear-gradient(135deg, #2196f3 0%, #1976d2 100%);
  color: white;
  border: none;
  padding: 12px 30px;
  border-radius: 8px;
  font-weight: 600;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 15px rgba(33, 150, 243, 0.3);
" onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 6px 20px rgba(33, 150, 243, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(33, 150, 243, 0.3)'">
ğŸ” é€šè¿‡è®¢å•å·æ‰¾å›è®¿é—®ç 
</button>
</div> 

**è¯´æ˜ï¼š**
- è®¢å•å·æˆ–è€…å•†å®¶è®¢å•å·å¯åœ¨æ”¯ä»˜å®çš„**è´¦å•è®°å½•**é‡Œæ‰¾åˆ°ã€‚
- **å•†å®¶è®¢å•å·**æ ¼å¼å¦‚ `IC17575395673154298`
- **è®¢å•å·**æ ¼å¼å¦‚ `2025097832001480241441480505`
</div>

### å¦‚ä½•é€€æ¬¾ï¼Ÿ

<div style="background: #e8f5e8; padding: 20px; border-radius: 8px; margin: 15px 0; border-left: 4px solid #4caf50;">
æˆ‘ä»¬ç†è§£æ‚¨å¯èƒ½ä¼šé‡åˆ°å„ç§æƒ…å†µï¼Œå› æ­¤æä¾› <strong>7å¤©æ— ç†ç”±é€€æ¬¾æ”¿ç­–</strong>ï¼š


**é€€æ¬¾æ¡ä»¶ï¼š**
- è´­ä¹°å7å¤©å†…å¯ç”³è¯·é€€æ¬¾
- è¶…è¿‡7å¤©ä¸æ”¯æŒé€€æ¬¾

**åœ¨çº¿é€€æ¬¾ï¼š**
<div style="margin: 15px 0; text-align: center;">
<button id="refund-btn" style="
  background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
  color: white;
  border: none;
  padding: 12px 30px;
  border-radius: 8px;
  font-weight: 600;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 15px rgba(245, 101, 101, 0.3);
" onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 6px 20px rgba(245, 101, 101, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(245, 101, 101, 0.3)'">
ç”³è¯·åœ¨çº¿é€€æ¬¾
</button>
</div>
</div>

### æœ‰å…¶ä»–é—®é¢˜ï¼Ÿæ¬¢è¿è”ç³»æˆ‘ï¼
<div style="background: #e3f2fd; padding: 20px; border-radius: 8px; margin: 15px 0; border-left: 4px solid #2196f3;">
å¦‚æœæ‚¨åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°ä»¥ä¸‹ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿é€šè¿‡ä¸‹é¢çš„è”ç³»æ–¹å¼è”ç³»æˆ‘ï¼Œæˆ‘ä¼šå°½å¿«ä¸ºæ‚¨è§£å†³ï¼š

- ä½¿ç”¨å·¥å…·æ—¶æœ‰é‡åˆ°bug
- æ‰¾å›è®¿é—®ç ä¸èƒ½æ­£å¸¸å·¥ä½œ
- é€€æ¬¾æŒ‰é’®ä¸èƒ½æ­£å¸¸å·¥ä½œ
- è¯¢é—®ä»»ä½•å…¶ä»–å…³äºäº§å“çš„å’¨è¯¢

**è”ç³»æ–¹å¼ï¼š**
- é‚®ç®±ï¼š**service@icstudio.club**  
- è”ç³»é¡µé¢ï¼š[ç‚¹æ­¤è®¿é—®](/contact/)
- æ‰€æœ‰ä¿¡æ¯å°†åœ¨æœ€å¤š 48 å°æ—¶å†…å›å¤
</div>

</div>

<!-- ç®€åŒ–è„šæœ¬ -->
<!-- CloudBase SDK -->
<script src="https://imgcache.qq.com/qcloud/cloudbase-js-sdk/1.5.0/cloudbase.full.js"></script>

<!-- ç»Ÿä¸€æ”¯ä»˜æˆåŠŸå¤„ç†å™¨ -->
<script src="/js/payment-success-handler.js?v=20250909"></script>

<!-- è¯•ç”¨ç³»ç»Ÿ -->
<script src="/js/trial-limiter.js?v=20250909"></script>
<script src="/js/cloudbase-api.js?v=20250909"></script>

<!-- æ”¯ä»˜çŠ¶æ€ç®¡ç†å™¨ -->
<script src="/js/payment-state-manager.js?v=20250909"></script>

<!-- ä¸‹è½½å¤„ç†å‡½æ•° -->
<script>
function downloadFile(url, filename) {
    console.log('ğŸ”½ å¼€å§‹ä¸‹è½½æ–‡ä»¶:', filename);
    console.log('ğŸ”— åŸå§‹URL:', url);
    
    // æ„å»ºå®Œæ•´URL
    const fullUrl = new URL(url, window.location.origin).href;
    console.log('ğŸ“ å®Œæ•´URL:', fullUrl);
    
    // åˆ›å»ºä¸´æ—¶ä¸‹è½½é“¾æ¥å…ƒç´ 
    const downloadLink = document.createElement('a');
    downloadLink.href = fullUrl;
    downloadLink.download = filename;
    downloadLink.style.display = 'none';
    
    // æ·»åŠ åˆ°é¡µé¢
    document.body.appendChild(downloadLink);
    
    try {
        // è§¦å‘ä¸‹è½½
        downloadLink.click();
        console.log('âœ… ä¸‹è½½å·²å¯åŠ¨:', filename);
        showDownloadNotification(filename);
    } catch (error) {
        console.error('âŒ ä¸‹è½½å¤±è´¥:', error);
        // é™çº§åˆ°ç›´æ¥æ‰“å¼€
        window.open(fullUrl, '_blank');
        showDownloadNotification(filename);
    }
    
    // æ¸…ç†ä¸´æ—¶å…ƒç´ 
    setTimeout(() => {
        if (downloadLink.parentNode) {
            document.body.removeChild(downloadLink);
        }
    }, 100);
}

function showDownloadNotification(message, type = 'success') {
    // åˆ›å»ºä¸´æ—¶é€šçŸ¥
    const notification = document.createElement('div');
    const bgColor = type === 'success' ? '#22c55e' : '#ef4444';
    
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: ${bgColor};
        color: white;
        padding: 15px 20px;
        border-radius: 8px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        z-index: 10000;
        font-size: 14px;
        font-weight: 600;
    `;
    
    if (type === 'success') {
        notification.innerHTML = `ğŸ”½ æ­£åœ¨ä¸‹è½½ ${message}...`;
    } else {
        notification.innerHTML = `âŒ ${message}`;
    }
    
    document.body.appendChild(notification);
    
    // 3ç§’åç§»é™¤é€šçŸ¥
    setTimeout(() => {
        if (notification.parentNode) {
            notification.style.opacity = '0';
            notification.style.transition = 'opacity 0.3s ease';
            setTimeout(() => {
                if (notification.parentNode) {
                    document.body.removeChild(notification);
                }
            }, 300);
        }
    }, 3000);
}

function copyAccessCode(accessCode) {
    console.log('ğŸ“‹ å¤åˆ¶è®¿é—®ç :', accessCode);
    
    // ä½¿ç”¨ç°ä»£çš„Clipboard API
    if (navigator.clipboard && window.isSecureContext) {
        navigator.clipboard.writeText(accessCode).then(() => {
            showCopyNotification('è®¿é—®ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
        }).catch(err => {
            console.error('å¤åˆ¶å¤±è´¥:', err);
            fallbackCopyTextToClipboard(accessCode);
        });
    } else {
        // é™çº§æ–¹æ¡ˆ
        fallbackCopyTextToClipboard(accessCode);
    }
}

function fallbackCopyTextToClipboard(text) {
    const textArea = document.createElement('textarea');
    textArea.value = text;
    textArea.style.top = '0';
    textArea.style.left = '0';
    textArea.style.position = 'fixed';
    
    document.body.appendChild(textArea);
    textArea.focus();
    textArea.select();
    
    try {
        const successful = document.execCommand('copy');
        if (successful) {
            showCopyNotification('è®¿é—®ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
        } else {
            showCopyNotification('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶', 'error');
        }
    } catch (err) {
        console.error('Fallbackå¤åˆ¶å¤±è´¥:', err);
        showCopyNotification('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶', 'error');
    }
    
    document.body.removeChild(textArea);
}

function showCopyNotification(message, type = 'success') {
    const notification = document.createElement('div');
    const bgColor = type === 'success' ? '#22c55e' : '#ef4444';
    
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: ${bgColor};
        color: white;
        padding: 15px 20px;
        border-radius: 8px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        z-index: 10000;
        font-size: 14px;
        font-weight: 600;
    `;
    notification.innerHTML = `ğŸ“‹ ${message}`;
    
    document.body.appendChild(notification);
    
    // 2ç§’åç§»é™¤é€šçŸ¥
    setTimeout(() => {
        if (notification.parentNode) {
            notification.style.opacity = '0';
            notification.style.transition = 'opacity 0.3s ease';
            setTimeout(() => {
                if (notification.parentNode) {
                    document.body.removeChild(notification);
                }
            }, 300);
        }
    }, 2000);
}

// è®¿é—®ç éªŒè¯ç›¸å…³å‡½æ•°
function handleInputChange() {
    const input = document.getElementById('access-code-input');
    const btn = document.getElementById('verify-btn');
    
    if (input.value.trim().length >= 8) {
        btn.style.cursor = 'pointer';
        btn.style.opacity = '1';
        btn.style.background = '#667eea';
    } else {
        btn.style.cursor = 'not-allowed';
        btn.style.opacity = '0.7';
        btn.style.background = '#999';
    }
}

async function handleVerifyClick() {
    const input = document.getElementById('access-code-input');
    const btn = document.getElementById('verify-btn');
    const resultDiv = document.getElementById('verify-result');
    
    const accessCode = input.value.trim().toUpperCase();
    
    if (accessCode.length < 8) {
        resultDiv.innerHTML = '<div style="color: #e74c3c; background: #ffeaa7; padding: 10px; border-radius: 8px;">âŒ è¯·è¾“å…¥æœ‰æ•ˆçš„è®¿é—®ç </div>';
        return;
    }
    
    // æ˜¾ç¤ºéªŒè¯ä¸­çŠ¶æ€
    const originalText = btn.innerHTML;
    btn.innerHTML = 'éªŒè¯ä¸­...';
    btn.disabled = true;
    
    try {
        // è°ƒç”¨CloudBaseéªŒè¯å‡½æ•°ï¼ˆå¤ç”¨æ”¯ä»˜æˆåŠŸæ—¶çš„checkOrderDetailsï¼‰
        const response = await fetch('https://cloud1-4g1r5ho01a0cfd85-1377702774.ap-shanghai.app.tcloudbase.com/checkOrderDetails', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-Request-Source': 'IC-Studio-Access-Verify'
            },
            body: JSON.stringify({
                access_code: accessCode
            })
        });
        
        const result = await response.json();
        console.log('ğŸ” è®¿é—®ç éªŒè¯ç»“æœ:', result);
        
        if (result.success && result.order_data) {
            const orderData = result.order_data;
            
            // æ˜¾ç¤ºéªŒè¯æˆåŠŸä¿¡æ¯å’Œä¸‹è½½é€‰é¡¹
            resultDiv.innerHTML = `
                <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; border: 1px solid #4caf50;">
                    <div style="color: #2e7d32; font-weight: bold; margin-bottom: 10px;">
                        âœ… è®¿é—®ç éªŒè¯æˆåŠŸï¼
                    </div>
                    <div style="font-size: 12px; color: #666; margin-bottom: 15px;">
                        è®¢å•å·ï¼š${orderData.orderNumber}<br>
                        è´­ä¹°æ—¶é—´ï¼š${new Date(orderData.paymentTime).toLocaleString()}
                    </div>
                    
                    <!-- ä¸‹è½½é€‰é¡¹ -->
                    <div style="margin-top: 15px;">
                        <div style="font-weight: bold; margin-bottom: 10px; color: #17a2b8;">
                            ğŸ“¦ ä¸‹è½½å®‰è£…åŒ…
                        </div>
                        <button id="show-download-panel-btn" onclick="toggleDownloadPanel()" style="
                            background: #17a2b8;
                            color: white;
                            border: none;
                            padding: 10px 20px;
                            border-radius: 6px;
                            cursor: pointer;
                            font-weight: 600;
                            font-size: 13px;
                            width: 100%;
                            margin-bottom: 10px;
                        ">
                            ğŸ’» é€‰æ‹©å®‰è£…åŒ…
                        </button>
                        
                        <!-- ä¸‹è½½é¢æ¿ï¼ˆåˆå§‹éšè—ï¼‰ -->
                        <div id="download-panel" style="display: none; background: #f8f9fa; padding: 15px; border-radius: 6px; margin-top: 10px;">
                            <div style="text-align: left;">
                                <!-- Windows -->
                                <div style="margin-bottom: 10px;">
                                    <div style="font-weight: bold; font-size: 12px; margin-bottom: 5px; color: #dc3545;">
                                        ğŸ–¥ï¸ Windows
                                    </div>
                                    <button class="download-platform-btn" data-platform="windows-exe" style="
                                        margin: 2px 3px 2px 0;
                                        padding: 6px 10px;
                                        background: #dc3545;
                                        color: white;
                                        border: none;
                                        border-radius: 4px;
                                        cursor: pointer;
                                        font-size: 10px;
                                        font-weight: 500;
                                    ">
                                        æ ‡å‡†ç‰ˆ (140.9MB)
                                    </button>
                                    <button class="download-platform-btn" data-platform="windows-x64" style="
                                        margin: 2px 3px 2px 0;
                                        padding: 6px 10px;
                                        background: #dc3545;
                                        color: white;
                                        border: none;
                                        border-radius: 4px;
                                        cursor: pointer;
                                        font-size: 10px;
                                        font-weight: 500;
                                    ">
                                        ä¼˜åŒ–ç‰ˆ (73.2MB)
                                    </button>
                                </div>
                                
                                <!-- macOS -->
                                <div style="margin-bottom: 10px;">
                                    <div style="font-weight: bold; font-size: 12px; margin-bottom: 5px; color: #6f42c1;">
                                        ğŸ macOS
                                    </div>
                                    <button class="download-platform-btn" data-platform="macos-x64-dmg" style="
                                        margin: 2px 3px 2px 0;
                                        padding: 6px 10px;
                                        background: #6f42c1;
                                        color: white;
                                        border: none;
                                        border-radius: 4px;
                                        cursor: pointer;
                                        font-size: 10px;
                                        font-weight: 500;
                                    ">
                                        Intel (DMG)
                                    </button>
                                    <button class="download-platform-btn" data-platform="macos-x64-zip" style="
                                        margin: 2px 3px 2px 0;
                                        padding: 6px 10px;
                                        background: #6f42c1;
                                        color: white;
                                        border: none;
                                        border-radius: 4px;
                                        cursor: pointer;
                                        font-size: 10px;
                                        font-weight: 500;
                                    ">
                                        Intel (ZIP)
                                    </button>
                                    <button class="download-platform-btn" data-platform="macos-arm64-zip" style="
                                        margin: 2px 3px 2px 0;
                                        padding: 6px 10px;
                                        background: #6f42c1;
                                        color: white;
                                        border: none;
                                        border-radius: 4px;
                                        cursor: pointer;
                                        font-size: 10px;
                                        font-weight: 500;
                                    ">
                                        M1/M2/M3 (ZIP)
                                    </button>
                                </div>
                                
                                <!-- Linux -->
                                <div style="margin-bottom: 5px;">
                                    <div style="font-weight: bold; font-size: 12px; margin-bottom: 5px; color: #fd7e14;">
                                        ğŸ§ Linux
                                    </div>
                                    <button class="download-platform-btn" data-platform="linux-deb" style="
                                        margin: 2px 3px 2px 0;
                                        padding: 6px 10px;
                                        background: #fd7e14;
                                        color: white;
                                        border: none;
                                        border-radius: 4px;
                                        cursor: pointer;
                                        font-size: 10px;
                                        font-weight: 500;
                                    ">
                                        DEBåŒ… (70.3MB)
                                    </button>
                                    <button class="download-platform-btn" data-platform="linux-appimage" style="
                                        margin: 2px 3px 2px 0;
                                        padding: 6px 10px;
                                        background: #fd7e14;
                                        color: white;
                                        border: none;
                                        border-radius: 4px;
                                        cursor: pointer;
                                        font-size: 10px;
                                        font-weight: 500;
                                    ">
                                        AppImage (77.6MB)
                                    </button>
                                </div>
                                
                                <div style="font-size: 9px; color: #6c757d; margin-top: 8px; line-height: 1.3;">
                                    ğŸ’¡ <strong>èŠ¯ç‰‡é€‰æ‹©è¯´æ˜ï¼š</strong><br>
                                    â€¢ Intel èŠ¯ç‰‡ Mac é€‰æ‹© x64 ç‰ˆæœ¬<br>
                                    â€¢ Apple Silicon (M1/M2/M3) é€‰æ‹© arm64 ç‰ˆæœ¬
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // ç»‘å®šä¸‹è½½æŒ‰é’®äº‹ä»¶
            bindDownloadEvents(accessCode);
            
        } else {
            resultDiv.innerHTML = `<div style="color: #e74c3c; background: #ffeaa7; padding: 10px; border-radius: 8px;">âŒ ${result.error || 'è®¿é—®ç æ— æ•ˆæˆ–å·²å¤±æ•ˆ'}</div>`;
        }
        
    } catch (error) {
        console.error('âŒ éªŒè¯å¤±è´¥:', error);
        resultDiv.innerHTML = '<div style="color: #e74c3c; background: #ffeaa7; padding: 10px; border-radius: 8px;">âŒ éªŒè¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥</div>';
    }
    
    // æ¢å¤æŒ‰é’®çŠ¶æ€
    btn.innerHTML = originalText;
    btn.disabled = false;
}

function toggleDownloadPanel() {
    const panel = document.getElementById('download-panel');
    const btn = document.getElementById('show-download-panel-btn');
    
    if (panel.style.display === 'none') {
        panel.style.display = 'block';
        btn.innerHTML = 'ğŸ“¦ æ”¶èµ·é€‰é¡¹';
    } else {
        panel.style.display = 'none';
        btn.innerHTML = 'ğŸ’» é€‰æ‹©å®‰è£…åŒ…';
    }
}

function bindDownloadEvents(accessCode) {
    // ç»‘å®šæ‰€æœ‰ä¸‹è½½æŒ‰é’®
    document.querySelectorAll('.download-platform-btn').forEach(btn => {
        btn.onclick = async function() {
            const platform = this.getAttribute('data-platform');
            const originalText = this.innerHTML;
            this.innerHTML = 'â³ è·å–...';
            
            try {
                console.log(`ğŸ“¥ å¼€å§‹ä¸‹è½½ ${platform} ç‰ˆæœ¬`);
                
                // è°ƒç”¨ä¸‹è½½äº‘å‡½æ•°
                const response = await fetch('https://cloud1-4g1r5ho01a0cfd85-1377702774.ap-shanghai.app.tcloudbase.com/downloadInstaller', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Request-Source': 'IC-Studio-Access-Verify'
                    },
                    body: JSON.stringify({
                        access_code: accessCode,
                        platform: platform
                    })
                });
                
                const result = await response.json();
                console.log('ğŸ“¥ ä¸‹è½½å“åº”:', result);
                
                if (result.success && result.data && result.data.download_url) {
                    // åˆ›å»ºä¸‹è½½é“¾æ¥
                    const link = document.createElement('a');
                    link.href = result.data.download_url;
                    link.download = result.data.package_info.name;
                    link.style.display = 'none';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    // æ˜¾ç¤ºæˆåŠŸçŠ¶æ€
                    this.innerHTML = 'âœ… ä¸‹è½½ä¸­';
                    console.log(`ğŸ‰ ${result.data.package_info.name} ä¸‹è½½å·²å¼€å§‹`);
                    
                    showDownloadNotification(result.data.package_info.name);
                    
                } else {
                    throw new Error(result.error || 'è·å–ä¸‹è½½é“¾æ¥å¤±è´¥');
                }
            } catch (error) {
                console.error('âŒ ä¸‹è½½å¤±è´¥:', error);
                this.innerHTML = 'âŒ å¤±è´¥';
                showDownloadNotification('ä¸‹è½½å¤±è´¥ï¼š' + error.message, 'error');
            }
            
            // 3ç§’åæ¢å¤æŒ‰é’®æ–‡æœ¬
            setTimeout(() => {
                this.innerHTML = originalText;
            }, 3000);
        };
    });
}

// ç»‘å®šå¼¹çª—ä¸‹è½½æŒ‰é’®äº‹ä»¶
function bindPopupDownloadEvents(accessCode) {
    document.querySelectorAll('.popup-download-btn').forEach(btn => {
        btn.onclick = async function() {
            const platform = this.getAttribute('data-platform');
            const originalText = this.innerHTML;
            this.innerHTML = 'â³ è·å–é“¾æ¥...';
            this.disabled = true;
            
            try {
                console.log(`ğŸ“¥ å¼¹çª—ä¸‹è½½ ${platform} ç‰ˆæœ¬`);
                
                // è°ƒç”¨CloudBase downloadInstalleræœåŠ¡
                const response = await fetch('https://cloud1-4g1r5ho01a0cfd85-1377702774.ap-shanghai.app.tcloudbase.com/downloadInstaller', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Request-Source': 'IC-Studio-Success-Popup'
                    },
                    body: JSON.stringify({
                        access_code: accessCode,
                        platform: platform
                    })
                });
                
                const result = await response.json();
                console.log('ğŸ“¥ å¼¹çª—ä¸‹è½½å“åº”:', result);
                
                if (result.success && result.data && result.data.download_url) {
                    // åˆ›å»ºä¸‹è½½é“¾æ¥
                    const link = document.createElement('a');
                    link.href = result.data.download_url;
                    link.download = result.data.package_info.name;
                    link.style.display = 'none';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    // æ˜¾ç¤ºæˆåŠŸçŠ¶æ€
                    this.innerHTML = 'âœ… ä¸‹è½½å¼€å§‹';
                    console.log(`ğŸ‰ å¼¹çª—ä¸‹è½½æˆåŠŸ: ${result.data.package_info.name}`);
                    
                    showDownloadNotification(result.data.package_info.name);
                    
                } else {
                    throw new Error(result.error || 'è·å–ä¸‹è½½é“¾æ¥å¤±è´¥');
                }
            } catch (error) {
                console.error('âŒ å¼¹çª—ä¸‹è½½å¤±è´¥:', error);
                this.innerHTML = 'âŒ ä¸‹è½½å¤±è´¥';
                showDownloadNotification('ä¸‹è½½å¤±è´¥ï¼š' + error.message, 'error');
            }
            
            // 3ç§’åæ¢å¤æŒ‰é’®çŠ¶æ€
            setTimeout(() => {
                this.innerHTML = originalText;
                this.disabled = false;
            }, 3000);
        };
    });
}
</script>

<!-- Z-Pay ç®€åŒ–é¡µé¢è·³è½¬æ”¯ä»˜å®ç° -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
<script src="/js/new-refund-handler.js?v=2.0.0"></script>
<script src="/js/zpay-simple.js?v=1.0.9"></script>

<!-- æ”¯ä»˜å®è´¦å·æŸ¥æ‰¾è®¿é—®ç åŠŸèƒ½ -->
<script src="/js/alipay-lookup.js?v=1.0.1"></script>

<!-- è¯•ç”¨çŠ¶æ€æ˜¾ç¤ºåŒºåŸŸ -->
<div id="trial-status" style="margin: 20px 0; padding: 15px; border-radius: 8px; background: #f8f9fa; display: none;"></div>

<!-- è°ƒè¯•ä¸‹è½½æµ‹è¯• -->

<!-- æ ·å¼å®šä¹‰ -->
<style>
.trial-expired {
  text-align: center;
  background: #fff5f5;
  border: 2px solid #fed7d7;
  padding: 20px;
  border-radius: 8px;
}

.trial-expired h3 {
  color: #c53030;
  margin-bottom: 10px;
}

.trial-welcome {
  text-align: center;
  background: #f0fff4;
  border: 2px solid #9ae6b4;
  padding: 20px;
  border-radius: 8px;
}

.trial-welcome h3 {
  color: #2f855a;
  margin-bottom: 10px;
}

.trial-active {
  text-align: center;
  background: #ebf8ff;
  border: 2px solid #90cdf4;
  padding: 15px;
  border-radius: 8px;
}

.trial-active h3 {
  color: #2b6cb0;
  margin-bottom: 10px;
}

.trial-active .warning {
  color: #d69e2e;
  font-weight: 500;
  margin-top: 10px;
}

.upgrade-options {
  margin-top: 20px;
}

.upgrade-btn {
  display: inline-block;
  background: linear-gradient(135deg, #1677FF 0%, #00A0E9 100%);
  color: white !important;
  padding: 15px 30px;
  border-radius: 12px;
  text-decoration: none !important;
  font-weight: 600;
  box-shadow: 0 8px 25px rgba(22, 119, 255, 0.3);
  transition: all 0.3s ease;
}

.upgrade-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 35px rgba(22, 119, 255, 0.4);
}

.upgrade-btn.primary {
  font-size: 16px;
}

.note {
  font-size: 12px;
  color: #666;
  margin-top: 10px;
}

.trial-warning-popup {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
}

.warning-content {
  background: white;
  padding: 30px;
  border-radius: 12px;
  max-width: 400px;
  text-align: center;
  box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
}

.warning-buttons {
  margin-top: 20px;
  display: flex;
  gap: 15px;
  justify-content: center;
}

.btn-secondary, .btn-primary {
  padding: 10px 20px;
  border-radius: 6px;
  text-decoration: none;
  font-weight: 500;
  cursor: pointer;
  border: none;
  transition: all 0.3s ease;
}

.btn-secondary {
  background: #f7fafc;
  color: #2d3748;
  border: 1px solid #e2e8f0;
}

.btn-primary {
  background: #667eea;
  color: white;
}

.btn-secondary:hover {
  background: #edf2f7;
}

.btn-primary:hover {
  background: #5a6fd8;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
  .trial-warning-popup .warning-content {
    margin: 20px;
    padding: 20px;
  }
  
  .warning-buttons {
    flex-direction: column;
  }
}
</style>

<script>
// é¡µé¢åŠ è½½å®Œæˆåæ˜¾ç¤ºè¯•ç”¨çŠ¶æ€
document.addEventListener('DOMContentLoaded', function() {
  const statusElement = document.getElementById('trial-status');
  if (statusElement) {
    statusElement.style.display = 'block';
  }
  
});



// æ˜¾ç¤ºçŠ¶æ€ä¿¡æ¯
function showStatus(message, type) {
  console.log(`[çŠ¶æ€] ${message} (ç±»å‹: ${type})`);
  // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ æ›´å¤šçš„çŠ¶æ€æ˜¾ç¤ºé€»è¾‘
}

// ç­‰å¾…Z-Payæ”¯ä»˜ç³»ç»Ÿå®Œå…¨åŠ è½½
document.addEventListener('DOMContentLoaded', function() {
  console.log('âœ… é¡µé¢åŠ è½½å®Œæˆï¼Œæ”¯ä»˜ç³»ç»Ÿå·²å°±ç»ª');
  
  // æ£€æŸ¥æ”¯ä»˜å›è°ƒå‚æ•°
  const urlParams = new URLSearchParams(window.location.search);
  if (urlParams.get('out_trade_no') || urlParams.get('trade_no')) {
    console.log('ğŸ‰ æ£€æµ‹åˆ°æ”¯ä»˜å›è°ƒ');
    // è¿™é‡Œå¯ä»¥å¤„ç†æ”¯ä»˜æˆåŠŸåçš„é€»è¾‘
    if (window.showUnifiedPaymentSuccess) {
      const accessCode = generateRandomCode();
      window.showUnifiedPaymentSuccess(accessCode, 'zpay-success');
    }
  }
  
  // æ£€æŸ¥Z-Payæ”¯ä»˜ç³»ç»Ÿæ˜¯å¦åŠ è½½
  if (typeof window.createZPayment === 'function') {
    console.log('âœ… Z-Payæ”¯ä»˜ç³»ç»Ÿå·²åŠ è½½');
  } else {
    console.warn('âš ï¸ Z-Payæ”¯ä»˜ç³»ç»ŸæœªåŠ è½½');
  }
});

// ç”Ÿæˆéšæœºè®¿é—®ç 
function generateRandomCode() {
  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
  let code = '';
  for (let i = 0; i < 12; i++) {
    code += chars.charAt(Math.floor(Math.random() * chars.length));
  }
  return code;
}

// å¤„ç†è¾“å…¥å˜åŒ–ï¼ˆå€Ÿé‰´ sight-reading-generator.html çš„é£æ ¼ï¼‰
function handleInputChange() {
    const input = document.getElementById('access-code-input');
    const button = document.getElementById('verify-btn');
    
    if (input && button) {
        const code = input.value.trim();
        const isValid = code.length >= 11 && code.length <= 12 && /^[A-Z0-9]+$/.test(code);
        
        // ä¿®æ”¹é€æ˜åº¦é€»è¾‘ï¼šè¾“å…¥æ¡†ä¸ºç©ºæˆ–æœ‰æ•ˆæ—¶éƒ½ä¿æŒå®Œå…¨ä¸é€æ˜
        button.dataset.valid = isValid;
        button.style.opacity = '1'; // å§‹ç»ˆä¿æŒå®Œå…¨ä¸é€æ˜
        button.style.cursor = isValid ? 'pointer' : 'not-allowed';
        button.style.background = '#667eea';
        
        console.log('ğŸ”„ è¾“å…¥å˜åŒ–å¤„ç†:', { code, isValid });
    }
}

// å¤„ç†éªŒè¯æŒ‰é’®ç‚¹å‡»
function handleVerifyClick() {
    console.log('ğŸ¯ éªŒè¯æŒ‰é’®è¢«ç‚¹å‡»');
    const button = document.getElementById('verify-btn');
    
    if (!button) {
        console.error('âŒ æ‰¾ä¸åˆ°éªŒè¯æŒ‰é’®');
        return;
    }
    
    const isValid = button.dataset.valid === 'true';
    console.log('ğŸ” æŒ‰é’®çŠ¶æ€æ£€æŸ¥:', { isValid });
    
    if (!isValid) {
        console.log('âš ï¸ æŒ‰é’®å¤„äºç¦ç”¨çŠ¶æ€ï¼Œä¸æ‰§è¡ŒéªŒè¯');
        const resultDiv = document.getElementById('verify-result');
        if (resultDiv) {
            resultDiv.innerHTML = '<span style="color: #e74c3c;">âŒ è¯·è¾“å…¥æœ‰æ•ˆçš„11-12ä½è®¿é—®ç </span>';
        }
        return;
    }
    
    // æ‰§è¡ŒéªŒè¯
    console.log('âœ… å¼€å§‹æ‰§è¡Œè®¿é—®ç éªŒè¯');
    verifyAccessCodeWithServer();
}

// ä¿æŒæ—§å‡½æ•°å…¼å®¹æ€§
function updateVerifyButton() {
    handleInputChange();
}

// æµ‹è¯•éªŒè¯åŠŸèƒ½
function testVerifyFunction() {
    console.log('ğŸ§ª æµ‹è¯•éªŒè¯åŠŸèƒ½...');
    const input = document.getElementById('access-code-input');
    const resultDiv = document.getElementById('verify-result');
    
    if (input && resultDiv) {
        input.value = 'VTTBY9XCFTQY';
        handleInputChange(); // æ›´æ–°æŒ‰é’®çŠ¶æ€
        resultDiv.innerHTML = '<span style="color: #27ae60;">ğŸ§ª æµ‹è¯•æ¨¡å¼ - è®¿é—®ç å·²å¡«å…¥ï¼ŒæŒ‰é’®ç°åœ¨åº”è¯¥å¯ä»¥ç‚¹å‡»äº†</span>';
        console.log('âœ… å·²å¡«å…¥æµ‹è¯•è®¿é—®ç ï¼ŒæŒ‰é’®çŠ¶æ€å·²æ›´æ–°');
        
        // ç»™å‡ºæ˜ç¡®çš„æµ‹è¯•è¯´æ˜
        setTimeout(() => {
            resultDiv.innerHTML = '<span style="color: #3498db;">ğŸ’¡ ç°åœ¨ç‚¹å‡»"éªŒè¯"æŒ‰é’®æµ‹è¯•åŠŸèƒ½</span>';
        }, 2000);
    }
}

// ä½¿ç”¨æœåŠ¡å™¨ç«¯éªŒè¯è®¿é—®ç 
async function verifyAccessCodeWithServer() {
    const input = document.getElementById('access-code-input');
    const resultDiv = document.getElementById('verify-result');
    const button = document.getElementById('verify-btn');
    
    if (!input || !resultDiv) {
        console.error('âŒ æ‰¾ä¸åˆ°å¿…è¦çš„é¡µé¢å…ƒç´ ');
        return;
    }
    
    const code = input.value.trim().toUpperCase();
    if (!code) {
        resultDiv.innerHTML = '<span style="color: #e74c3c;">âŒ è¯·è¾“å…¥è®¿é—®ç </span>';
        return;
    }
    
    if (code.length !== 12 && code.length !== 11) {
        resultDiv.innerHTML = '<span style="color: #e74c3c;">âŒ è®¿é—®ç å¿…é¡»æ˜¯11-12ä½</span>';
        return;
    }
    
    if (!/^[A-Z0-9]+$/.test(code)) {
        resultDiv.innerHTML = '<span style="color: #e74c3c;">âŒ è®¿é—®ç åªèƒ½åŒ…å«å­—æ¯å’Œæ•°å­—</span>';
        return;
    }

    // ç¦ç”¨æŒ‰é’®é˜²æ­¢é‡å¤ç‚¹å‡»
    button.disabled = true;
    button.style.opacity = '0.5';
    resultDiv.innerHTML = '<span style="color: #3498db;">ğŸ”„ æ­£åœ¨éªŒè¯è®¿é—®ç ...</span>';

    try {
        // ç­‰å¾… PaymentStateManager åŠ è½½
        if (!window.paymentManager) {
            resultDiv.innerHTML = '<span style="color: #f39c12;">â³ æ­£åœ¨åŠ è½½éªŒè¯ç³»ç»Ÿ...</span>';
            
            // ç­‰å¾…æœ€å¤š5ç§’è®©PaymentStateManageråŠ è½½
            let attempts = 0;
            while (!window.paymentManager && attempts < 50) {
                await new Promise(resolve => setTimeout(resolve, 100));
                attempts++;
            }
            
            if (!window.paymentManager) {
                throw new Error('éªŒè¯ç³»ç»ŸåŠ è½½è¶…æ—¶ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
            }
        }
        
        console.log('ğŸ” ä½¿ç”¨ PaymentStateManager éªŒè¯è®¿é—®ç :', code);
        resultDiv.innerHTML = '<span style="color: #3498db;">ğŸ”„ æ­£åœ¨æœåŠ¡å™¨éªŒè¯...</span>';
        
        const result = await window.paymentManager.verifyAccessCode(code, true);
        
        if (result.success) {
            console.log('âœ… è®¿é—®ç éªŒè¯æˆåŠŸ:', result.data);
            resultDiv.innerHTML = '<span style="color: #27ae60;">âœ… è®¿é—®ç éªŒè¯æˆåŠŸï¼</span>';
            
            // é‡æ–°å¯ç”¨æŒ‰é’®
            button.disabled = false;
            button.style.opacity = '1';
            
            // å»¶è¿Ÿæ˜¾ç¤ºå¼¹çª—ï¼Œè®©ç”¨æˆ·çœ‹åˆ°æˆåŠŸæ¶ˆæ¯
            setTimeout(() => {
                showPaymentSuccessPopup(code, result.data);
            }, 800);
            
        } else {
            console.log('âŒ è®¿é—®ç éªŒè¯å¤±è´¥:', result.error);
            resultDiv.innerHTML = `<span style="color: #e74c3c;">âŒ ${result.error}</span>`;
            button.disabled = false;
            button.style.opacity = '1';
        }
    } catch (error) {
        console.error('éªŒè¯è®¿é—®ç å¤±è´¥:', error);
        resultDiv.innerHTML = `<span style="color: #e74c3c;">âŒ ${error.message || 'éªŒè¯å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•'}</span>`;
        button.disabled = false;
        button.style.opacity = '1';
    }
}

// æ˜¾ç¤ºæ”¯ä»˜æˆåŠŸå¼¹çª—
function showPaymentSuccessPopup(accessCode, orderData) {
    // åˆ›å»ºå¼¹çª—HTML
    const popup = document.createElement('div');
    popup.id = 'success-popup';
    popup.innerHTML = `
        <div style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.7); display: flex; align-items: center; justify-content: center; z-index: 10000;">
            <div style="background: white; padding: 40px; border-radius: 16px; max-width: 500px; width: 90%; text-align: center; box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);">
                <div style="margin-bottom: 30px;">
                    <div style="width: 80px; height: 80px; background: #4CAF50; border-radius: 50%; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center; font-size: 48px;">âœ“</div>
                    <h2 style="color: #333; margin-bottom: 10px;">ğŸ‰ è®¿é—®éªŒè¯æˆåŠŸï¼</h2>
                    <p style="color: #666; font-size: 16px; margin-bottom: 0;">æ‚¨çš„è®¿é—®ç å·²éªŒè¯ï¼Œç°åœ¨å¯ä»¥ä½¿ç”¨å®Œæ•´ç‰ˆåŠŸèƒ½</p>
                </div>
                
                <div style="background: #f8f9fa; padding: 20px; border-radius: 12px; margin-bottom: 30px; text-align: left;">
                    <h3 style="color: #333; margin-bottom: 15px; text-align: center;">ğŸ“‹ éªŒè¯ä¿¡æ¯</h3>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px; align-items: center;">
                        <span style="color: #666;">è®¿é—®ç ï¼š</span>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="font-family: monospace; font-weight: bold; background: #f1f5f9; padding: 4px 8px; border-radius: 4px; border: 1px solid #e2e8f0;">${accessCode}</span>
                            <button onclick="copyAccessCode('${accessCode}')" 
                                    style="background: #3b82f6; color: white; border: none; padding: 6px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; font-weight: 600; transition: all 0.2s ease;"
                                    onmouseover="this.style.background='#2563eb'"
                                    onmouseout="this.style.background='#3b82f6'"
                                    title="å¤åˆ¶è®¿é—®ç ">
                                ğŸ“‹
                            </button>
                        </div>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span style="color: #666;">äº§å“ï¼š</span>
                        <span>${orderData.product_name || 'IC Studio è§†å¥å·¥å…·'}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span style="color: #666;">éªŒè¯æ—¶é—´ï¼š</span>
                        <span>${new Date().toLocaleString()}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color: #666;">è®¢å•å·ï¼š</span>
                        <span style="font-family: monospace; background: #f1f5f9; padding: 4px 8px; border-radius: 4px; border: 1px solid #e2e8f0;">${(orderData.order_info?.out_trade_no) || (orderData.order_info?.order_id) || orderData.out_trade_no || orderData.order_id || orderData.orderId || 'æš‚æ— '}</span>
                    </div>
                </div>

                <div style="margin-bottom: 30px;">
                    <h3 style="color: #333; margin-bottom: 20px;">ğŸ“¦ ä¸‹è½½å®‰è£…åŒ…</h3>
                    <div style="display: grid; gap: 10px;">
                        <button class="popup-download-btn" data-platform="windows-x64"
                               style="display: block; background: #f0f9ff; color: #1e40af; padding: 12px 20px; border: 2px solid #93c5fd; border-radius: 8px; text-decoration: none; font-weight: 600; transition: all 0.3s ease; cursor: pointer; border: none; width: 100%;"
                               onmouseover="this.style.background='#1e40af'; this.style.color='white';" 
                               onmouseout="this.style.background='#f0f9ff'; this.style.color='#1e40af';">
                            ğŸ’» Windows x64 (73.2MB)
                        </button>
                        <button class="popup-download-btn" data-platform="macos-x64-dmg"
                               style="display: block; background: #f0fdf4; color: #166534; padding: 12px 20px; border: 2px solid #86efac; border-radius: 8px; text-decoration: none; font-weight: 600; transition: all 0.3s ease; cursor: pointer; border: none; width: 100%;"
                               onmouseover="this.style.background='#166534'; this.style.color='white';" 
                               onmouseout="this.style.background='#f0fdf4'; this.style.color='#166534';">
                            ğŸ macOS Intel (DMG - 86.2MB)
                        </button>
                        <button class="popup-download-btn" data-platform="macos-arm64-zip"
                               style="display: block; background: #fef3c7; color: #92400e; padding: 12px 20px; border: 2px solid #fbbf24; border-radius: 8px; text-decoration: none; font-weight: 600; transition: all 0.3s ease; cursor: pointer; border: none; width: 100%;"
                               onmouseover="this.style.background='#92400e'; this.style.color='white';" 
                               onmouseout="this.style.background='#fef3c7'; this.style.color='#92400e';">
                            ğŸ macOS Apple Silicon (ZIP - 86.6MB)
                        </button>
                        <button class="popup-download-btn" data-platform="linux-appimage"
                               style="display: block; background: #ede9fe; color: #6b21a8; padding: 12px 20px; border: 2px solid #c084fc; border-radius: 8px; text-decoration: none; font-weight: 600; transition: all 0.3s ease; cursor: pointer; border: none; width: 100%;"
                               onmouseover="this.style.background='#6b21a8'; this.style.color='white';" 
                               onmouseout="this.style.background='#ede9fe'; this.style.color='#6b21a8';">
                            ğŸ§ Linux (AppImage - 77.6MB)
                        </button>
                    </div>
                    <p style="font-size: 12px; color: #888; margin-top: 15px;">ä¸‹è½½å®Œæˆåï¼Œä½¿ç”¨ä»¥ä¸Šè®¿é—®ç æ¿€æ´»å®Œæ•´ç‰ˆåŠŸèƒ½</p>
                </div>

                <div style="display: flex; gap: 15px; justify-content: center;">
                    <button onclick="closeSuccessPopup()" 
                            style="padding: 15px 30px; background: #f8f9fa; color: #333; border: 2px solid #e2e8f0; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s ease;"
                            onmouseover="this.style.background='#e2e8f0'" 
                            onmouseout="this.style.background='#f8f9fa'">
                        ç¨åä½¿ç”¨
                    </button>
                    <button onclick="goToSightReadingTool()" 
                            style="padding: 15px 30px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3); transition: all 0.3s ease;"
                            onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 6px 20px rgba(102, 126, 234, 0.4)'" 
                            onmouseout="this.style.transform='translateY(0px)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.3)'">
                        ğŸš€ å¼€å§‹ä½¿ç”¨
                    </button>
                </div>
            </div>
        </div>
    `;
    
    document.body.appendChild(popup);
    
    // ç»‘å®šå¼¹çª—ä¸‹è½½æŒ‰é’®äº‹ä»¶
    bindPopupDownloadEvents(accessCode);
}

// å…³é—­æˆåŠŸå¼¹çª—
function closeSuccessPopup() {
    const popup = document.getElementById('success-popup');
    if (popup) {
        popup.remove();
    }
}

// å‰å¾€è§†å¥å·¥å…·é¡µé¢
function goToSightReadingTool() {
    closeSuccessPopup();
    // è·³è½¬åˆ°å®Œæ•´ç‰ˆè§†å¥å·¥å…·é¡µé¢
    window.open('/tools/sight-reading-generator.html', '_blank');
}

// ç¡®ä¿æ‰€æœ‰åŠŸèƒ½åœ¨DOMåŠ è½½åå°±ç»ª
document.addEventListener('DOMContentLoaded', function() {
    console.log('ğŸ”§ IC Studio è§†å¥å·¥å…·é¡µé¢åˆå§‹åŒ–å¼€å§‹...');
    
    // æ£€æŸ¥å…³é”®å…ƒç´ 
    const input = document.getElementById('access-code-input');
    const button = document.getElementById('verify-btn');
    const resultDiv = document.getElementById('verify-result');
    
    if (!input || !button || !resultDiv) {
        console.error('âŒ å…³é”®é¡µé¢å…ƒç´ ç¼ºå¤±');
        return;
    }
    
    console.log('âœ… é¡µé¢å…ƒç´ æ£€æŸ¥é€šè¿‡');
    
    // ç¡®ä¿æŒ‰é’®åˆå§‹çŠ¶æ€æ­£ç¡®
    handleInputChange();
    
    // æ£€æŸ¥PaymentStateManagerçŠ¶æ€
    function checkPaymentManager() {
        if (window.paymentManager) {
            console.log('âœ… PaymentStateManager å·²å°±ç»ª');
            
            // æ£€æŸ¥æ˜¯å¦æœ‰å·²æ”¯ä»˜çŠ¶æ€
            const hasPaid = window.paymentManager.hasPaidAccess();
            if (hasPaid) {
                console.log('ğŸ‰ æ£€æµ‹åˆ°å·²æ”¯ä»˜çŠ¶æ€');
                const accessCode = window.paymentManager.getCurrentAccessCode();
                if (accessCode) {
                    console.log('ğŸ’¡ å½“å‰è®¿é—®ç :', accessCode);
                }
            }
        } else {
            console.log('â³ ç­‰å¾… PaymentStateManager åŠ è½½...');
            setTimeout(checkPaymentManager, 500);
        }
    }
    
    // å»¶è¿Ÿæ£€æŸ¥PaymentStateManagerï¼ˆç»™è„šæœ¬åŠ è½½æ—¶é—´ï¼‰
    setTimeout(checkPaymentManager, 1000);
    
    console.log('ğŸ¯ è®¿é—®ç éªŒè¯åŠŸèƒ½å·²åˆå§‹åŒ–å®Œæˆ');
    console.log('ğŸ’¡ ç°åœ¨å¯ä»¥è¾“å…¥æœ‰æ•ˆçš„è®¿é—®ç è¿›è¡ŒéªŒè¯äº†');
    console.log('ğŸ§ª æµ‹è¯•åŠŸèƒ½: testVerifyFunction() - è‡ªåŠ¨å¡«å…¥æµ‹è¯•è®¿é—®ç ');
});

// é€€æ¬¾åŠŸèƒ½å·²ç§»è‡³ /js/refund-handler.js

// æš´éœ²æµ‹è¯•å‡½æ•°åˆ°å…¨å±€ä½œç”¨åŸŸ
window.testVerifyFunction = testVerifyFunction;

// æµ‹è¯•å‡½æ•°å·²ç§»è‡³ refund-handler.js

</script>